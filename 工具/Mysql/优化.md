# 优化

配置文件优化

1. 调整BufferPool. 

   BufferPool是Mysql中重要的缓存池. 增删改查都需要在BufferPool中执行. BuffetPool太小会导致Mysql频繁读取硬盘

   BufferPool默认128M. 官方建议可以修改为机器内存的50%~70%. `innodb_buffer_pool_size`
   
2. 调整ChangeBuffer

   ChangeBuffer是BufferPool中的一部分, 用于缓存增删改的数据. 对于频繁查询但改动小的情况可以适当调小对于占比
   
   ChangeBuffer默认占比37%. 可以按需调整`innodb_change_buffer_max_size`





表层级优化

1. 顺序插入. 因为索引底层使用B+树. 对于B+树来说顺序插入是最快的方式, 随机插入在读取时还可能会出现页分裂影响性能

   > 页分裂: 

2. 不要更新主键. 更新主键意味着要修改B+树, B+树对应的叶子节点的数据也要进行迁移

3. 尽量不要更新索引列. 因为更新索引列意味着B+树要修改

4. 索引尽量使用离散度高的

5. 联合索引的左索引离散度也要尽量高

6. 什么数据类型就用什么去搜索, 避免隐式转换导致索引失效

2. 如没有必要不要返回全表数据. 特别是联合索引, 如果只需要联合索引对应的字段就只返回联合索引字段, 可以避免再查一查聚集索引

